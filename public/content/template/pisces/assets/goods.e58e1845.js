import{_ as M,d as I,r as R,a as U,o as S,w as $,c as E,b as d,f as o,A as G,h as l,i as n,e as u,m as c,g as m,t as k,n as _,j as L,F as z,l as N,p as J,H as K}from"./index.08eb56a6.js";import{a as O}from"./goods.23bc6ffd.js";import{F as P,H as Q}from"./footer.dd270afd.js";import{L as j}from"./storage.d2b28a6e.js";const W={class:"container"},X=["src"],Y={class:"goods-name-box"},Z={class:"goods-name mr-2"},ee={class:"goods-params"},ae={style:{"margin-top":"20px"}},oe={style:{"margin-top":"20px"},class:"sku-block example-block"},te={style:{"margin-right":"10px"}},se=["data-sku-name","data-sku","id","onClick"],de=_("\u63D0\u4EA4\u8BA2\u5355"),ne=_("\u8BF7\u9009\u62E9\u89C4\u683C"),le=_("\u5E93\u5B58\u4E0D\u8DB3"),ie=_("\u5F53\u524D\u5546\u54C1\u6682\u672A\u6DFB\u52A0\u4ECB\u7ECD~"),ce=["innerHTML"],re={class:"dialog-footer"},ge=_("\u786E\u5B9A"),ue=I({__name:"goods",setup(me){const B=G(),e=R({goods_num:1,ejectDialog:!1,goods:{category:{name:""}},form:{},data:{template:{site:{}}},goods_dialog:!1,sku_all:!0,real_price:0}),D=U();S(()=>{$(()=>{e.data.template=D.value.state.data,e.goods_id!=B.query.goods_id&&B.query.goods_id!=null&&(e.goods_id=B.query.goods_id,O(e.goods_id).then(p=>{if(console.log(D.value.state.data),e.data.template=D.value.state.data,e.goods=p.data.goods,e.real_price=e.goods.real_price,e.goods.sku!=""&&e.goods.sku!=null&&(e.sku_all=!1),e.goods.eject!=""&&e.goods.eject!=null){var t=j.get("goods_dialog_"+e.goods_id);e.data.template.date!=t&&(e.ejectDialog=!0)}else if(e.data.template.options.goods_eject!=""&&e.data.template.options.goods_eject!=null){e.goods.eject=e.data.template.options.goods_eject;var t=j.get("goods_dialog_"+e.goods_id);e.data.template.date!=t&&(e.ejectDialog=!0)}J(e.goods.name+" - "+e.data.template.site.shop_title)}))})});var H=(p,t)=>{var C,V;for(var b=document.getElementsByClassName(t),y=(C=document.getElementById(p))==null?void 0:C.classList.contains("active"),a=0;a<b.length;a++)b[a].classList.remove("active");y||(V=document.getElementById(p))==null||V.classList.add("active");for(var v=document.getElementsByClassName("sku-block"),w=!0,h=[],i={name:[],ids:[],price:0},a=0;a<v.length;a++){for(var f=v[a].getElementsByClassName("tag"),F=!1,r=0;r<f.length;r++)f[r].classList.contains("active")&&(F=!0,h.push(f[r].getAttribute("data-sku")),i.name.push(f[r].getAttribute("data-sku-name")),i.ids.push(f[r].getAttribute("data-sku")));if(F)w=!0;else{w=!1;break}}if(e.sku_all=w,e.sku_all==!0){h=h.toString();for(var A=e.data.template.user,s=[],g=0,a=0;a<e.goods.price.length;a++)h==e.goods.price[a].sku_ids&&s.push(e.goods.price[a]);for(var a=0;a<s.length;a++)A.agent>=s[a].grade_id&&(g=s[a].price,e.real_price=g);e.goods_num=1;var x=g*e.goods_num;e.goods.real_price=x.toFixed(2),i.price=g,console.log(i),j.set("goods-sku-"+e.goods.id,i)}},T=()=>{var p=e.real_price*e.goods_num;e.goods.real_price=p.toFixed(2)},q=()=>{e.ejectDialog=!1,e.goods_dialog==!0&&j.set("goods_dialog_"+B.query.goods_id,e.data.template.date)};return(p,t)=>{const b=l("el-col"),y=l("el-tag"),a=l("el-input-number"),v=l("el-button"),w=l("router-link"),h=l("el-row"),i=l("el-card"),f=l("el-main"),F=l("el-checkbox"),r=l("el-dialog"),A=l("el-container");return n(),E("div",W,[d(Q,{ref_key:"headerRef",ref:D},null,512),d(A,null,{default:o(()=>[d(f,{class:"main"},{default:o(()=>[d(i,{class:"box-card","body-style":"padding: 20px;"},{default:o(()=>[d(h,{gutter:30,class:"card-row"},{default:o(()=>[e.data.template.hidden_cover==0?(n(),u(b,{key:0,xs:24,sm:9,md:8,lg:8,xl:8},{default:o(()=>[c("img",{class:"goods-image",src:e.goods.cover},null,8,X)]),_:1})):m("",!0),d(b,{xs:24,sm:15,md:16,lg:16,xl:16},{default:o(()=>[c("div",Y,[c("span",Z,k(e.goods.name),1),e.data.template.stock==1?(n(),u(y,{key:0,class:"",type:"warning"},{default:o(()=>[_("\u5E93\u5B58"+k(e.goods.stock_show),1)]),_:1})):m("",!0),e.data.template.sales==1?(n(),u(y,{key:1,class:"ml-2",type:"info"},{default:o(()=>[_("\u9500\u91CF"+k(e.goods.sales),1)]),_:1})):m("",!0)]),c("div",ee,[d(y,{class:"goods-price",type:"danger"},{default:o(()=>[_("\uFFE5"+k(e.goods.real_price),1)]),_:1}),d(a,{class:"goods-number",modelValue:e.goods_num,"onUpdate:modelValue":t[0]||(t[0]=s=>e.goods_num=s),min:1,max:9999,onChange:t[1]||(t[1]=s=>L(T)())},null,8,["modelValue"]),c("div",ae,[(n(!0),E(z,null,N(e.goods.sku,(s,g)=>(n(),E("div",oe,[c("span",te,k(s.name),1),(n(!0),E(z,null,N(s.value,(x,C)=>(n(),E("span",{"data-sku-name":g+"\uFF1A"+x.name,class:K("tag tag-"+g),"data-sku":x.id,id:"tag-"+x.id+C,onClick:V=>L(H)("tag-"+x.id+C,"tag-"+g)},k(x.name),11,se))),256))]))),256))]),c("div",null,[e.goods.stock>0&&e.sku_all==!0?(n(),u(w,{key:0,to:{path:"/cfm",query:{goods_id:e.goods.id,goods_num:e.goods_num}}},{default:o(()=>[d(v,{type:"primary",class:"sub-btn",size:"large "},{default:o(()=>[de]),_:1})]),_:1},8,["to"])):m("",!0),e.goods.stock>0&&e.sku_all==!1?(n(),u(v,{key:1,type:"primary",class:"sub-btn",size:"large",disabled:""},{default:o(()=>[ne]),_:1})):m("",!0),e.goods.stock<1?(n(),u(v,{key:2,type:"primary",class:"sub-btn",size:"large",disabled:""},{default:o(()=>[le]),_:1})):m("",!0)])])]),_:1})]),_:1})]),_:1}),e.goods.details!=""?(n(),u(i,{key:0,shadow:"always",class:"box-card goods-details",innerHTML:e.goods.details,style:{padding:"15px 20px","margin-top":"20px"}},null,8,["innerHTML"])):m("",!0),e.goods.details==""?(n(),u(i,{key:1,shadow:"always",class:"box-card",style:{"margin-top":"20px"}},{default:o(()=>[ie]),_:1})):m("",!0)]),_:1}),d(r,{modelValue:e.ejectDialog,"onUpdate:modelValue":t[3]||(t[3]=s=>e.ejectDialog=s),"custom-class":"eject-dialog",draggable:"","show-close":!1},{footer:o(()=>[c("span",re,[d(F,{modelValue:e.goods_dialog,"onUpdate:modelValue":t[2]||(t[2]=s=>e.goods_dialog=s),label:"\u4ECA\u65E5\u4E0D\u518D\u5F39\u51FA",size:"large",style:{position:"absolute",left:"15px",bottom:"10px"}},null,8,["modelValue"]),d(v,{type:"primary",onClick:L(q)},{default:o(()=>[ge]),_:1},8,["onClick"])])]),default:o(()=>[c("div",{innerHTML:e.goods.eject},null,8,ce)]),_:1},8,["modelValue"])]),_:1}),d(P,{pet_name:e.data.template.site.shop_pet_name,beian:e.data.template.site.beian},null,8,["pet_name","beian"])])}}});var xe=M(ue,[["__scopeId","data-v-25dcce29"]]);export{xe as default};
